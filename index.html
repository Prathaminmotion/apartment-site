<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Room for Growth</title>

  <style>
    /* Reset & Base */
    *,*::before,*::after{box-sizing:border-box}
    html,body{margin:0;padding:0;height:100%}
    body{
      background: var(--bg, #0f1114);
      color: var(--text, #eaeef5);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      line-height: 1.35;
      transition: background .45s ease, color .45s ease;
    }

    /* Theme vars (shifted by day/night state) */
    :root{
      --bg:#0f1114;
      --panel:#1a1d24;
      --text:#eaeef5;
      --muted:#a8b0bf;
      --accent:#7dd3fc; /* soft neon blue */
      --overlay-opa: 0;         /* lighting intensity */
      --overlay-grad: radial-gradient(60% 60% at 75% 25%, rgba(255,210,130,.0) 0%, rgba(255,180,90,.0) 40%, rgba(0,0,0,.0) 60%);
      --vignette-opa: 0;        /* vignette at night */
    }
    [data-theme="dawn"]{
      --bg:#0e1116; --panel:#171b21; --accent:#8be3ff;
      --overlay-opa:.25; --overlay-grad: linear-gradient(180deg, rgba(150,200,255,.12), rgba(255,200,140,.10)); --vignette-opa:.08;
    }
    [data-theme="day"]{
      --bg:#0e1014; --panel:#171b21; --accent:#7dd3fc;
      --overlay-opa:.12; --overlay-grad: linear-gradient(180deg, rgba(140,200,255,.10), rgba(140,200,255,.06)); --vignette-opa:.05;
    }
    [data-theme="dusk"]{
      --bg:#0e0f12; --panel:#17181e; --accent:#87c8ff;
      --overlay-opa:.35; --overlay-grad: radial-gradient(60% 60% at 80% 20%, rgba(255,170,120,.35), rgba(0,0,0,0) 60%); --vignette-opa:.14;
    }
    [data-theme="night"]{
      --bg:#0a0c10; --panel:#14161a; --accent:#6ec1ff;
      --overlay-opa:.45; --overlay-grad: linear-gradient(180deg, rgba(30,60,120,.28), rgba(10,20,40,.32)); --vignette-opa:.22;
    }

    /* Room container & image */
    #room-container{position:relative; text-align:center; max-width:1536px; margin:0 auto;}
    #room-image{max-width:100%; height:auto; display:block; margin:0 auto; user-select:none}

    /* Lighting overlays (sit over the image) */
    .lighting,.vignette{
      position:absolute; inset:0; pointer-events:none; z-index:1;
      opacity:var(--overlay-opa); transition: opacity .6s ease;
    }
    .lighting{ background: var(--overlay-grad); mix-blend-mode: soft-light; }
    .vignette{
      opacity:var(--vignette-opa);
      background: radial-gradient(130% 130% at 50% 60%, rgba(0,0,0,0) 55%, rgba(0,0,0,0.55) 100%);
      mix-blend-mode: multiply;
    }

    /* Dots */
    .dot{
      position:absolute; z-index:2; width:16px; height:16px; border-radius:50%;
      border:2px solid rgba(255,255,255,0.85); background: rgba(255,255,255,0.22);
      transform: translate(-50%, -50%); cursor:pointer;
      transition: background .25s ease, transform .2s ease, box-shadow .2s ease;
      outline: none;
    }
    .dot:hover,.dot:focus-visible{
      background:#fff; transform: translate(-50%, -50%) scale(1.35);
      box-shadow: 0 6px 16px rgba(0,0,0,.45), 0 0 18px rgba(125,211,252,.55);
    }
    .dot::after{
      content: attr(data-label); position:absolute; bottom:135%; left:50%; transform:translateX(-50%);
      background: rgba(0,0,0,0.75); color:#fff; padding:2px 6px; border-radius:4px;
      font-size:12px; white-space:nowrap; opacity:0; transition:opacity .15s ease; pointer-events:none;
    }
    .dot:hover::after,.dot:focus-visible::after{opacity:1}

    /* Dot positions (center of each item, responsive %) for 1536x1024 base */
    .dot-laptop    { left: 59.52%;  top: 45.41%; }
    .dot-window    { left: 61.70%;  top: 24.69%; }
    .dot-mirror    { left: 86.39%;  top: 32.24%; }
    .dot-bookshelf { left: 80.88%;  top: 53.88%; }
    .dot-desk      { left: 59.66%;  top: 56.02%; }
    .dot-tv        { left: 32.79%;  top: 41.53%; }
    .dot-art       { left: 32.11%;  top: 20.61%; }
    .dot-clothes   { left: 17.82%;  top: 35.51%; }
    .dot-bed       { left: 18.10%;  top: 85.51%; }
    /* Vault still hidden/clickable ‚Äî you can measure if you want exact */
    .dot-vault {
      left: 10.42%; top: 63.57%;
      width: 16px; height: 16px;
      background: transparent !important;
      border: none !important;
      cursor: pointer;
    }

    /* Base Modal (reused by zones, bookshelf, TV) */
    #content-modal{
      position:fixed; inset:0; background:rgba(0,0,0,.78);
      display:none; justify-content:center; align-items:center; z-index:1000;
      animation: fadeInOverlay .3s ease-out;
    }
    #modal-box{
      background: var(--panel); color: var(--text);
      padding: 1.25rem 1.25rem 1rem; border-radius: 12px;
      width: min(96vw, 880px);
      position:relative; box-shadow: 0 10px 30px rgba(0,0,0,.55); animation: slideIn .28s ease-out;
    }
    #close-btn{
      position:absolute; top:.5rem; right:.6rem; background:none; border:1px solid rgba(255,255,255,.12);
      color:var(--text); font-size:1.25rem; line-height:1; border-radius:8px; padding:.2rem .5rem; cursor:pointer;
    }
    #modal-content{ margin-top:.75rem; line-height:1.55; color:var(--text); }

    /* Animations */
    @keyframes fadeInOverlay{ from{opacity:0} to{opacity:1} }
    @keyframes slideIn{ from{ transform: translateY(-14px); opacity:0 } to{ transform:none; opacity:1 } }

    @media (prefers-reduced-motion: reduce){
      *{ transition:none !important; animation:none !important }
    }

    /* --- Bookshelf modal bits --- */
    .book-cover{
      width:120px; aspect-ratio:2/3; border-radius:10px;
      background:
        linear-gradient(180deg, rgba(255,255,255,.18), rgba(0,0,0,.25)),
        linear-gradient(180deg,#6b58a9,#3f356f);
      box-shadow:0 10px 18px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.28);
      position:relative; flex:0 0 auto;
    }
    .book-cover::after{
      content:""; position:absolute; left:8px; top:8px; bottom:8px; width:4px; border-radius:3px;
      background:linear-gradient(180deg, rgba(255,255,255,.4), rgba(255,255,255,.1));
    }
    .book-head{ display:flex; gap:14px; align-items:flex-start }
    .book-title{ margin:.2rem 0 .2rem; font-weight:700; font-size:1.15rem }
    .book-sub{ color:var(--muted); margin-bottom:.45rem }
    .book-syn{ color:#e7dec7; line-height:1.4 }
    .book-row{ display:flex; gap:8px; flex-wrap:wrap; margin-top:12px }
    .book-btn, .book-chip{
      background:#0f141e; color:#dce6ff; border:1px solid #243049; border-radius:10px;
      padding:8px 12px; cursor:pointer;
    }
    .book-chip{ background:#e9c46a; color:#3b2f1e; border:none }

    .list-wrap{ margin-top:12px; display:none; }
    .list-wrap.show{ display:block; }
    .list-controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:8px }
    .list-controls select, .list-controls input{
      background:#0f141e; color:#dbe4f6; border:1px solid #243049; border-radius:10px; padding:8px 10px;
    }
    .series-list{ max-height:56vh; overflow:auto; padding-right:6px }
    .series-group{ margin:10px 0 14px; }
    .series-title{
      font-weight:700; color:#f2ead3; background:#1a1f28; border:1px solid #2a3344;
      padding:6px 10px; border-radius:8px; position:sticky; top:0;
    }
    .book-item{
      display:flex; justify-content:space-between; align-items:center;
      padding:8px 10px; border-bottom:1px solid #1f2837; color:#eaeef5;
    }
    .book-item small{ color:#a9b6cf }

    /* --- Retro TV modal UI --- */
    .tv-wrap{
      position:relative;
      background:#0b0c10;
      border-radius:14px;
      padding:16px 16px 16px 16px;
    }
    /* CRT frame */
    .tv{
      position:relative;
      border-radius:18px;
      background: #2b241c;
      box-shadow: inset 0 2px 0 rgba(255,255,255,.08), 0 18px 40px rgba(0,0,0,.45);
      padding:18px 18px 18px 18px;
      display:grid;
      grid-template-columns: 1fr 140px; /* screen + knobs area */
      gap:14px;
    }
    .tv-frame{
      border-radius:16px;
      background: linear-gradient(180deg, #0d1016, #0a0d12);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.08), inset 0 -10px 18px rgba(0,0,0,.5);
      padding:10px;
      position:relative;
      overflow:hidden;
    }
    .tv-screen{
      border-radius:10px;
      background:#0a0c10;
      min-height:280px;
      position:relative;
      overflow:hidden;
      box-shadow: inset 0 0 60px rgba(0,0,0,.6);
    }
    /* scanline / glow */
    .tv-screen:before{
      content:"";
      position:absolute; inset:0;
      background: repeating-linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.02) 2px, transparent 2px, transparent 4px);
      pointer-events:none;
      mix-blend-mode:soft-light;
    }
    .tv-screen:after{
      content:"";
      position:absolute; inset:-30% -30%;
      background: radial-gradient(70% 60% at 50% 50%, rgba(120,180,255,.08), transparent 60%);
      pointer-events:none;
      mix-blend-mode:screen;
    }
    /* static effect */
    .tv-static{
      position:absolute; inset:0; pointer-events:none;
      background:
        repeating-conic-gradient(from 0deg, rgba(255,255,255,.06) 0 4deg, rgba(0,0,0,.06) 4deg 8deg),
        repeating-linear-gradient(90deg, rgba(255,255,255,.03) 0 3px, rgba(0,0,0,.03) 3px 6px);
      opacity:0; transition:opacity .15s ease;
    }
    .tv-static.show{ opacity:1; animation: fuzz .45s steps(14) forwards }
    @keyframes fuzz{
      0%{ transform:scale(1.02) }
      100%{ transform:scale(1) }
    }

    .screen-inner{
      position:absolute; inset:0; padding:16px; overflow:auto;
    }
    .ch-label{
      position:absolute; right:10px; top:10px;
      background: rgba(0,0,0,.45); color:#eaeef5; border:1px solid rgba(255,255,255,.15);
      padding:4px 8px; border-radius:999px; font-size:12px;
    }
    .tv-title{ font-weight:700; margin:0 0 6px; }
    .tv-sub{ color:#cfd9f0; margin:0 0 10px; font-size:.95rem }
    .tv-card{
      display:flex; gap:14px; align-items:flex-start;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      padding:12px; border-radius:10px;
    }
    .tv-cover{
      width:100px; aspect-ratio:2/3; border-radius:8px;
      background:
        linear-gradient(180deg, rgba(255,255,255,.18), rgba(0,0,0,.25)),
        linear-gradient(180deg,#5f6fb7,#37406d);
      box-shadow:0 10px 18px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.28);
      flex:0 0 auto;
    }
    .tv-text{ color:#eaeef5 }
    .tv-syn{ color:#e7dec7 }
    .tv-actions{ display:flex; gap:8px; margin-top:10px; flex-wrap:wrap }
    .btn{ background:#0f141e; color:#dce6ff; border:1px solid #243049; border-radius:10px; padding:8px 12px; cursor:pointer; }
    .btn:active{ transform:translateY(1px) }

    /* knobs column */
    .knobs{
      display:flex; flex-direction:column; gap:10px;
      background: linear-gradient(180deg, #1b1f27, #12151b);
      border:1px solid rgba(255,255,255,.08);
      border-radius:12px; padding:12px;
    }
    .knob{
      background: linear-gradient(180deg, #2a2f3a, #1a1f28);
      color:#d9e6ff; border:1px solid #313c52;
      border-radius:10px; padding:10px 12px; cursor:pointer; text-align:left;
    }
    .knob.active{
      outline:2px solid #7aa2ff; outline-offset:2px;
    }
    .subtabs{ display:flex; gap:8px; margin:8px 0 2px; flex-wrap:wrap }
    .subtab{
      background:#232a39; border:1px solid #32405a; color:#dce6ff;
      border-radius:999px; padding:6px 10px; cursor:pointer; font-size:.88rem;
    }
    .subtab.active{ background:#e9c46a; color:#2f2618; border-color:#e9c46a }

    /* guide (view all) inside screen */
    .guide{ margin-top:10px; display:none }
    .guide.show{ display:block }
    .guide-grid{
      display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:10px;
    }
    .guide-item{
      background: rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
      padding:10px; border-radius:10px;
    }
    .guide-item .title{ font-weight:700; margin-bottom:4px }
    .guide-item .meta{ color:#cfd9f0; font-size:.9rem; margin-bottom:4px }
    .guide-item .desc{ color:#e7dec7; font-size:.92rem }

  </style>
</head>
<body data-theme="day">
  <main id="room-container" aria-label="Interactive apartment room">
    <img id="room-image" src="room.png" alt="Interactive apartment room" draggable="false" />

    <!-- Lighting layers -->
    <div class="lighting" aria-hidden="true"></div>
    <div class="vignette" aria-hidden="true"></div>

    <!-- Floating dots -->
    <span class="dot dot-bed"        data-zone="bed"        data-label="Bed"        role="button" tabindex="0" aria-label="Open Bed"></span>
    <span class="dot dot-clothes"    data-zone="clothes"    data-label="Closet"     role="button" tabindex="0" aria-label="Open Closet"></span>
    <span class="dot dot-vault"      data-zone="vault"      data-label="Vault"      role="button" tabindex="0" aria-label="Open Vault"></span>
    <span class="dot dot-tv"         data-zone="tv"         data-label="TV"         role="button" tabindex="0" aria-label="Open TV"></span>
    <span class="dot dot-art"        data-zone="art"        data-label="Artwork"    role="button" tabindex="0" aria-label="Open Artwork"></span>
    <span class="dot dot-window"     data-zone="window"     data-label="Window"     role="button" tabindex="0" aria-label="Open Window"></span>
    <span class="dot dot-laptop"     data-zone="laptop"     data-label="Laptop"     role="button" tabindex="0" aria-label="Open Laptop"></span>
    <span class="dot dot-desk"       data-zone="desk"       data-label="Desk"       role="button" tabindex="0" aria-label="Open Desk"></span>
    <span class="dot dot-bookshelf"  data-zone="bookshelf"  data-label="Bookshelf"  role="button" tabindex="0" aria-label="Open Bookshelf"></span>
    <span class="dot dot-mirror"     data-zone="mirror"     data-label="Mirror"     role="button" tabindex="0" aria-label="Open Mirror"></span>
  </main>

  <!-- Modal -->
  <div id="content-modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div id="modal-box" role="document">
      <button id="close-btn" aria-label="Close">&times;</button>
      <div id="modal-content">Placeholder</div>
    </div>
  </div>

  <script>
    /* ---------- NON-BOOKSHELF BASE CONTENT ---------- */
    const CONTENT = {
      bed:     "üõè Your personal bed zone. Swap in dream logs or comfort items.",
      clothes: "üëï Closet: favorite outfits or style moodboard.",
      vault:   "üîê Secret vault: hidden notes or unreleased ideas.",
      tv:      "", // handled via openTvModal()
      art:     "üñº Inspiration wall or moodboard.",
      window:  "üåá Daily view or travel inspiration.",
      desk:    "üóÇ Project hub: portfolio tiles and progress.",
      mirror:  "ü™û Reflection prompts or a short bio."
    };

    const dots = document.querySelectorAll('.dot');
    const modal = document.getElementById('content-modal');
    const contentEl = document.getElementById('modal-content');
    const closeBtn = document.getElementById('close-btn');

    function themeForHour(h){
      if (h >= 5.5 && h < 7.5) return 'dawn';
      if (h >= 7.5 && h < 17.5) return 'day';
      if (h >= 17.5 && h < 20.5) return 'dusk';
      return 'night';
    }
    function applyTheme(){
      const now = new Date();
      const hour = now.getHours() + now.getMinutes()/60;
      document.body.setAttribute('data-theme', themeForHour(hour));
    }
    applyTheme();
    setInterval(applyTheme, 15*60*1000);

    function openZone(zone){
      if (zone === 'laptop') { window.location.href = 'laptop.html'; return; }
      if (zone === 'bookshelf') { openBookshelfModal(); return; }
      if (zone === 'tv') { openTvModal(); return; }

      const text = CONTENT[zone] || `No content for "${zone}".`;
      contentEl.textContent = text;
      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden','false');
      closeBtn.focus();
    }

    dots.forEach(dot=>{
      dot.addEventListener('click', ()=> openZone(dot.getAttribute('data-zone')));
      dot.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openZone(dot.getAttribute('data-zone')); }
      });
    });

    function hideModal(){
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden','true');
    }
    closeBtn.addEventListener('click', hideModal);
    modal.addEventListener('click', e => { if (e.target === modal) hideModal(); });
    document.addEventListener('keydown', e => { if (e.key === 'Escape' && modal.style.display === 'flex') hideModal(); });

    const vault = document.querySelector('.dot-vault');
    if (vault){
      vault.addEventListener('focus-visible', ()=>{ vault.style.outline = '2px dashed rgba(255,255,255,.5)'; vault.style.outlineOffset='2px'; });
      vault.addEventListener('blur', ()=>{ vault.style.outline = 'none'; });
    }

    /* ---------- BOOKSHELF MODAL (existing happy version) ---------- */
    const SERIES = [
      {
        id:"hp", series:"Harry Potter", author:"J.K. Rowling",
        synopsis:"A boy wizard and his friends come of age at Hogwarts while confronting the return of Lord Voldemort.",
        books:[
          {title:"Harry Potter and the Sorcerer's Stone", no:1},
          {title:"Harry Potter and the Chamber of Secrets", no:2},
          {title:"Harry Potter and the Prisoner of Azkaban", no:3},
          {title:"Harry Potter and the Goblet of Fire", no:4},
          {title:"Harry Potter and the Order of the Phoenix", no:5},
          {title:"Harry Potter and the Half-Blood Prince", no:6},
          {title:"Harry Potter and the Deathly Hallows", no:7},
        ]
      },
      {
        id:"pjo", series:"Percy Jackson & the Olympians", author:"Rick Riordan",
        synopsis:"A modern demigod discovers his heritage and embarks on mythic quests to keep the gods from war.",
        books:[
          {title:"The Lightning Thief", no:1},
          {title:"The Sea of Monsters", no:2},
          {title:"The Titan's Curse", no:3},
          {title:"The Battle of the Labyrinth", no:4},
          {title:"The Last Olympian", no:5},
        ]
      },
      {
        id:"wof", series:"Wings of Fire (Arc 1)", author:"Tui T. Sutherland",
        synopsis:"Five dragonets foretold to end a brutal war must decide whether to follow prophecy or forge their own path.",
        books:[
          {title:"The Dragonet Prophecy", no:1},
          {title:"The Lost Heir", no:2},
          {title:"The Hidden Kingdom", no:3},
          {title:"The Dark Secret", no:4},
          {title:"The Brightest Night", no:5},
        ]
      },
      {
        id:"wimpy", series:"Diary of a Wimpy Kid", author:"Jeff Kinney",
        synopsis:"Greg Heffley‚Äôs illustrated journals turn middle‚Äëschool mishaps into deadpan comedy.",
        books:[
          {title:"Diary of a Wimpy Kid", no:1},
          {title:"Rodrick Rules", no:2},
          {title:"The Last Straw", no:3},
          {title:"Dog Days", no:4},
          {title:"The Ugly Truth", no:5},
        ]
      }
    ];
    const EXTRAS = [
      {series:"Big Nate", author:"Lincoln Peirce", synopsis:"A wisecracking sixth‚Äëgrader turns everyday chaos into laugh‚Äëout‚Äëloud adventures.",
       books:[{title:"Big Nate: In a Class by Himself",no:1},{title:"Big Nate Strikes Again",no:2},{title:"Big Nate on a Roll",no:3}]},
      {series:"Jurassic Park", author:"Michael Crichton", synopsis:"A biotech breakthrough resurrects dinosaurs, proving nature and hubris are a lethal mix.",
       books:[{title:"Jurassic Park",no:1},{title:"The Lost World",no:2}]}
    ];
    const ALL_SERIES = [...SERIES, ...EXTRAS];
    const rnd = arr => arr[Math.floor(Math.random()*arr.length)];

    function openBookshelfModal(seriesId=null){
      const S = seriesId ? ALL_SERIES.find(s=>s.id===seriesId) : rnd(ALL_SERIES);
      const pick = rnd(S.books);

      contentEl.innerHTML = `
        <div class="book-head">
          <div class="book-cover" id="book-cover"></div>
          <div>
            <div class="book-title">${pick.title}</div>
            <div class="book-sub">by ${S.author} ‚Ä¢ #${pick.no} in ${S.series}</div>
            <p class="book-syn">${S.synopsis}</p>
            <div class="book-row">
              <button class="book-btn" id="btn-another" title="Click: any series ‚Ä¢ Shift+Click: same series">üé≤ Another random</button>
              <button class="book-chip" id="btn-all">All books</button>
            </div>

            <div class="list-wrap" id="books-list">
              <div class="list-controls">
                <label>Sort:
                  <select id="lst-sort">
                    <option value="title">Title (A‚ÜíZ)</option>
                    <option value="author">Author (A‚ÜíZ)</option>
                  </select>
                </label>
                <input id="lst-filter" placeholder="Search‚Ä¶">
                <button class="book-btn" id="btn-back">Back</button>
              </div>
              <div class="series-list" id="series-list"></div>
            </div>
          </div>
        </div>
      `;

      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden','false');

      const cover = document.getElementById('book-cover');
      cover.style.filter = `hue-rotate(${Math.floor(Math.random()*360)}deg)`;

      document.getElementById('btn-another').addEventListener('click', (e)=>{
        if(e.shiftKey){ openBookshelfModal(S.id); } else { openBookshelfModal(null); }
      });

      const listWrap = document.getElementById('books-list');
      document.getElementById('btn-all').onclick = ()=>{ listWrap.classList.add('show'); renderSections() };
      document.getElementById('btn-back').onclick = ()=> listWrap.classList.remove('show');

      function renderSections(){
        const sortSel = document.getElementById('lst-sort');
        const filterEl = document.getElementById('lst-filter');
        const host = document.getElementById('series-list');

        function draw(){
          const q = (filterEl.value||'').toLowerCase();
          host.innerHTML = '';
          const key = sortSel.value;
          [...ALL_SERIES].forEach(series=>{
            const items = series.books
              .map(b => ({...b, series: series.series, author: series.author}))
              .filter(r => !q || r.title.toLowerCase().includes(q) || r.author.toLowerCase().includes(q) || r.series.toLowerCase().includes(q))
              .sort((a,b)=> String(a[key]).localeCompare(String(b[key])));
            if(!items.length) return;
            const group = document.createElement('div');
            group.className = 'series-group';
            group.innerHTML = `<div class="series-title">${series.series} <small>by ${series.author}</small></div>`;
            items.forEach(r=>{
              const row = document.createElement('div');
              row.className = 'book-item';
              row.innerHTML = `<span>${r.title}</span><small>#${r.no} ‚Äî ${r.author}</small>`;
              group.appendChild(row);
            });
            host.appendChild(group);
          });
        }
        document.getElementById('lst-sort').onchange = draw;
        document.getElementById('lst-filter').oninput = draw;
        draw();
      }
    }

    /* ---------- TV MODAL: RETRO CHANNEL SURFING ---------- */

    // DATA from your lists
    const TV_DATA = {
      movies: {
        subTabs: [
          {
            id:'alltime', name:'All‚ÄëTime Top 10', items: [
              {title:'Interstellar', desc:'A father ventures through space and time to save humanity‚Äôs future.'},
              {title:'Inception', desc:'A skilled thief enters dreams to plant an idea deep in a target‚Äôs mind.'},
              {title:'Madagascar', desc:'Zoo animals escape to the wild and discover life beyond their cage.'},
              {title:'Iron Man (2008)', desc:'A billionaire builds a suit of armor to fight his own weapons.'},
              {title:'Knives Out', desc:'A witty detective unravels a twisted family murder mystery.'},
              {title:'Avengers', desc:'Earth‚Äôs mightiest heroes unite to stop an alien invasion.'},
              {title:'Tower Heist', desc:'Employees plot revenge on the mogul who swindled them.'},
              {title:'Se7en', desc:'Detectives hunt a killer who follows the seven deadly sins.'},
              {title:'Sinners', desc:'A gritty crime tale about choices and consequences.'},
              {title:'The Dark Knight', desc:'Batman faces a moral trial against the Joker‚Äôs chaos.'},
            ]
          },
          {
            id:'indian', name:'Indian Top 5', items: [
              {title:'Housefull 3', desc:'Three men try to prove they deserve love and family approval.'},
              {title:'3 Idiots', desc:'Friendship and purpose collide in a college coming‚Äëof‚Äëage.'},
              {title:'Krrish', desc:'A man discovers his superhuman legacy‚Äîand a destiny to protect.'},
              {title:'Hera Pheri', desc:'A get‚Äërich‚Äëquick scheme spirals into hilarious chaos.'},
              {title:'Aankhen', desc:'A daring bank heist executed by an unlikely team.'},
            ]
          }
        ]
      },
      shows: {
        items: [
          {title:'Brooklyn Nine‚ÄëNine', desc:'A quirky precinct solves crimes and cracks jokes.'},
          {title:'Game of Thrones', desc:'Noble houses clash for the Iron Throne.'},
          {title:'Breaking Bad', desc:'A chemistry teacher enters the criminal underworld.'},
          {title:'Modern Family', desc:'A loving, chaotic family navigates life together.'},
          {title:'How I Met Your Mother', desc:'A winding tale of love, friendship, and fate.'},
        ]
      },
      cartoons: {
        items: [
          {title:'Fullmetal Alchemist', desc:'Brothers use alchemy to fix what was lost.'},
          {title:'Invincible', desc:'A young hero confronts shocking truths.'},
          {title:'Attack on Titan', desc:'Humanity fights giants behind towering walls.'},
          {title:'Naruto', desc:'A boy ninja dreams of becoming Hokage.'},
          {title:'Super Hero Squad Show', desc:'Marvel heroes team up for lighthearted fun.'},
        ]
      },
      youtube: {
        items: [
          {title:'Poet Plays', desc:'Story‚Äëdriven gaming with community vibes.'},
          {title:'MrBeast', desc:'Over‚Äëthe‚Äëtop challenges and philanthropy.'},
          {title:'Ryan Higa', desc:'Classic sketches and creative shorts.'},
          {title:'Syntac', desc:'Chill survival/building gameplay and guides.'},
          {title:'The King of Random', desc:'DIY science and curiosity projects.'},
        ]
      },
      music: {
        items: [
          {title:'Drake', desc:'Rap/R&B crossover hits and melodies.'},
          {title:'21 Savage', desc:'Gritty storytelling and icy delivery.'},
          {title:'Ye', desc:'Boundary‚Äëpushing production and vision.'},
          {title:'Young Thug', desc:'Elastic flows and avant‚Äërap style.'},
          {title:'Gunna', desc:'Smooth, melodic trap anthems.'},
        ]
      }
    };

    const CHANNELS = [
      {id:'movies',  name:'Movies',   number:1},
      {id:'shows',   name:'TV Shows', number:2},
      {id:'cartoons',name:'Cartoons', number:3},
      {id:'youtube', name:'YouTube',  number:4},
      {id:'music',   name:'Music',    number:5},
    ];

    function openTvModal(){
      // Build TV structure inside the existing modal
      contentEl.innerHTML = `
        <div class="tv-wrap">
          <div class="tv">
            <div class="tv-frame">
              <div class="tv-screen">
                <div class="tv-static" id="tv-static"></div>
                <div class="screen-inner">
                  <div class="ch-label" id="tv-ch">CH 1</div>
                  <h3 class="tv-title" id="tv-title">Movies</h3>
                  <p class="tv-sub" id="tv-sub">Flip channels or pick a sub‚Äëchannel.</p>
                  <div class="subtabs" id="tv-subtabs"></div>
                  <div class="tv-card">
                    <div class="tv-cover" id="tv-cover"></div>
                    <div class="tv-text">
                      <div class="tv-item-title" id="tv-item-title" style="font-weight:700; margin-bottom:6px;">‚Äî</div>
                      <div class="tv-syn" id="tv-item-desc">‚Äî</div>
                      <div class="tv-actions">
                        <button class="btn" id="tv-random">üé≤ Random</button>
                        <button class="btn" id="tv-viewall">üìã View All</button>
                        <button class="btn" id="tv-power">‚èª Off</button>
                      </div>
                      <div class="guide" id="tv-guide">
                        <div class="tv-actions" style="margin:8px 0 6px">
                          <button class="btn" id="tv-guide-back">‚¨Ö Back</button>
                        </div>
                        <div class="guide-grid" id="tv-guide-grid"></div>
                      </div>
                    </div>
                  </div>
                </div> <!-- /screen-inner -->
              </div> <!-- /tv-screen -->
            </div> <!-- /tv-frame -->

            <div class="knobs" id="tv-knobs"></div>
          </div>
        </div>
      `;

      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden','false');

      const staticEl = document.getElementById('tv-static');
      const chLbl = document.getElementById('tv-ch');
      const titleEl = document.getElementById('tv-title');
      const subEl = document.getElementById('tv-sub');
      const subtabsEl = document.getElementById('tv-subtabs');
      const itemTitle = document.getElementById('tv-item-title');
      const itemDesc = document.getElementById('tv-item-desc');
      const cover = document.getElementById('tv-cover');
      const guide = document.getElementById('tv-guide');
      const guideGrid = document.getElementById('tv-guide-grid');

      // build knobs
      const knobs = document.getElementById('tv-knobs');
      CHANNELS.forEach((c,i)=>{
        const b = document.createElement('button');
        b.className = 'knob';
        b.textContent = `CH ${c.number} ‚Äî ${c.name}`;
        b.dataset.ch = c.id;
        knobs.appendChild(b);
      });

      let currentChannel = 'movies';
      let currentSub = TV_DATA.movies.subTabs[0].id; // default to first movie subtab

      function showStatic(){ staticEl.classList.remove('show'); void staticEl.offsetWidth; staticEl.classList.add('show'); }
      function randomizeCover(){ cover.style.filter = `hue-rotate(${Math.floor(Math.random()*360)}deg)`; }

      function setActiveKnob(){
        [...knobs.children].forEach(k => k.classList.toggle('active', k.dataset.ch === currentChannel));
      }

      function renderSubtabs(){
        subtabsEl.innerHTML = '';
        if(currentChannel !== 'movies'){ return; }
        TV_DATA.movies.subTabs.forEach(st=>{
          const b = document.createElement('button');
          b.className = 'subtab' + (st.id===currentSub ? ' active':'');
          b.textContent = st.name;
          b.dataset.sub = st.id;
          b.onclick = ()=>{
            currentSub = st.id;
            flip(() => renderContent());
          };
          subtabsEl.appendChild(b);
        });
      }

      function getCurrentList(){
        if(currentChannel === 'movies'){
          const found = TV_DATA.movies.subTabs.find(s => s.id===currentSub) || TV_DATA.movies.subTabs[0];
          return found.items;
        }
        return TV_DATA[currentChannel].items;
      }

      function renderContent(){
        setActiveKnob();
        renderSubtabs();

        const chInfo = CHANNELS.find(c=>c.id===currentChannel);
        chLbl.textContent = `CH ${chInfo.number}`;
        titleEl.textContent = chInfo.name;

        if(currentChannel === 'movies'){
          const st = TV_DATA.movies.subTabs.find(s => s.id===currentSub);
          subEl.textContent = st ? st.name : '';
        } else {
          subEl.textContent = '';
        }

        const list = getCurrentList();
        const pick = list[Math.floor(Math.random()*list.length)];
        itemTitle.textContent = pick.title;
        itemDesc.textContent = pick.desc;
        randomizeCover();
        guide.classList.remove('show');
      }

      function flip(cb){
        showStatic();
        setTimeout(()=>{ cb && cb(); }, 260); // after static, render
      }

      // initial render
      renderContent();

      // knob events
      [...knobs.children].forEach(k=>{
        k.onclick = ()=>{
          const next = k.dataset.ch;
          if(next === currentChannel) return;
          currentChannel = next;
          // when entering movies, ensure a subtab exists
          if(currentChannel === 'movies' && !currentSub){
            currentSub = TV_DATA.movies.subTabs[0].id;
          }
          flip(() => renderContent());
        };
      });

      // actions
      document.getElementById('tv-random').onclick = ()=>{
        flip(() => {
          const list = getCurrentList();
          const pick = list[Math.floor(Math.random()*list.length)];
          itemTitle.textContent = pick.title;
          itemDesc.textContent = pick.desc;
          randomizeCover();
        });
      };

      document.getElementById('tv-viewall').onclick = ()=>{
        guide.classList.add('show');
        const list = getCurrentList();
        guideGrid.innerHTML = list.map(x => `
          <div class="guide-item">
            <div class="title">${x.title}</div>
            <div class="desc">${x.desc}</div>
          </div>
        `).join('');
      };
      document.getElementById('tv-guide-back').onclick = ()=> guide.classList.remove('show');

      document.getElementById('tv-power').onclick = hideModal;
    }
  </script>
</body>
</html>
